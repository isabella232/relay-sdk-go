version: "1.0"
description: description

parameters:
  dockerTagName:
    description: The repository tag to deploy

triggers:
  - name: my-scheduled-trigger
    source:
      type: schedule
      schedule: '* * * * */5'
    binding:
    - dockerTagName: latest
  - name: my-webhook
    source:
      type: webhooked
      image: projectnebula/dockerhub-push-trigger
    when: !Fn.matchesRegex [!Data tag, '^production-']
    binding:
    - dockerTagName: latest

steps:
  - name: do-something
    image: projectnebula/core
    input:
      - echo $( ni get .tagToDeploy )
    spec:
      tagToDeploy: !Parameter dockerTagName

